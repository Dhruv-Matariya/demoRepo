<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Gift</title>
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas&display=swap" rel="stylesheet">
    <style>
        :root {
            --gift-size: 200px;
        }

        * {
            box-sizing: border-box;
            padding: 0;
            margin: 0;
            border: 0;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            background-color: transparent;
            font-family: 'Mountains of Christmas', cursive;
            overflow: hidden;
            position: relative;
        }

        html::after,
        body::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            z-index: -1;
            width: 100%;
            height: 100%;
            background-image: url('backgoround.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0.6;
        }

        canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .headline {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-size: 20vw;
            color: rgba(255, 255, 255, 0.12);
            mix-blend-mode: overlay;
            user-select: none;
        }

        .instructions {
            position: absolute;
            top: 27%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            text-align: center;
            font-size: 7vw;
            color: black;
            user-select: none;
        }

        .credits {
            position: absolute;
            bottom: 0;
            right: 0;
            color: white;
            font-size: 20px;
        }

        .gift-video {
            position: absolute;
            top: 50%;
            left: 50%;
            z-index: 1;
            display: block;
            width: 10vw;
            height: auto;
            transform: translate3d(-50%, -50%, 0) rotateY(0) rotateX(0) scale(0);
            transition: all 3s ease-out .5s;
            user-select: none;
            object-fit: contain;
        }

        .present {
            position: absolute;
            top: 55%;
            left: 0;
            right: 0;
            width: var(--gift-size);
            height: var(--gift-size);
            margin: 0 auto;
            cursor: pointer;
            perspective: 600px;
            transform: translateY(-50%);
        }

        .wiggle-container {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transform-origin: bottom;
        }

        .present.animate .wiggle-container {
            animation: wiggle .3s ease 0s 1 normal forwards;
        }

        @keyframes wiggle {
            0% { transform: translateX(0) rotateX(0); }
            25% { transform: translateX(calc(var(--count) * -1px)) rotateX(calc(var(--count) * 1deg)); }
            50% { transform: translateX(0) rotateX(0); }
            75% { transform: translateX(calc(var(--count) * 1px)) rotateX(calc(var(--count) * -1deg)); }
            100% { transform: translateX(0) rotateX(0); }
        }

        .rotate-container {
            height: 100%;
            transform: rotateY(170deg);
            transform-style: preserve-3d;
            animation: present-rotate 30s infinite linear;
        }

        @keyframes present-rotate {
            0% { transform: rotateY(0); }
            100% { transform: rotateY(360deg); }
        }

        .bottom,
        .front,
        .left,
        .back,
        .right {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #111;
        }

        .bottom {
            transform: translateY(50%) rotateX(90deg);
        }

        .front,
        .left,
        .back,
        .right {
            transition: transform 1s ease-out 3s;
            transform-origin: bottom;
            transform-style: preserve-3d;
        }

        .front:after,
        .left:after,
        .back:after,
        .right:after,
        .lid-top:after,
        .lid-front:after,
        .lid-left:after,
        .lid-back:after,
        .lid-right:after {
            content: '';
            position: absolute;
            left: calc(50% - 10px);
            width: 20px;
            height: 100%;
            background-color: white;
            transform: translateZ(.1px);
        }

        .lid-top:before {
            content: '';
            position: absolute;
            top: calc(50% - 10px);
            left: 0;
            width: 100%;
            height: 20px;
            background-color: white;
            transform: translateZ(.1px);
        }

        .left { transform: translateX(-50%) rotateY(-90deg); }
        .back { transform: translateZ(calc(var(--gift-size) / -2)) rotateY(180deg) rotateX(0); }
        .right { transform: translateX(50%) rotateY(90deg); }
        .front { transform: translateZ(calc(var(--gift-size) / 2)); }

        .lid {
            animation: lid-animation 3.5s 1s infinite;
            transform: translate3d(0, 0, 0);
            transform-style: preserve-3d;
            transition: transform 1s ease-out 3s;
        }

        @keyframes lid-animation {
            0% { transform: translate3d(0, 0, 0) rotateX(0); }
            5% { transform: translate3d(0, -10px, -5px) rotateX(5deg); }
            10% { transform: translate3d(0, -10px, 5px) rotateX(-5deg); }
            15% { transform: translate3d(0, -10px, -5px) rotateX(5deg); }
            20% { transform: translate3d(0, -10px, 5px) rotateX(-5deg); }
            25% { transform: translate3d(0, -10px, -5px) rotateX(5deg); }
            30% { transform: translate3d(0, 0, 0) rotateX(0); }
        }

        .lid-top,
        .lid-left,
        .lid-back,
        .lid-right,
        .lid-front {
            position: absolute;
            top: 0;
            left: -5px;
            width: calc(var(--gift-size) + 10px);
            background-color: #222;
            opacity: 1;
        }

        .lid-top {
            top: -5px;
            height: calc(var(--gift-size) + 10px);
            transform: translateY(-50%) rotateX(90deg);
            transform-style: preserve-3d;
        }

        .lid-left,
        .lid-back,
        .lid-right,
        .lid-front {
            top: -5px;
            height: 40px;
            transform-style: preserve-3d;
        }

        .lid-left { transform: translateX(-50%) rotateY(-90deg); }
        .lid-back { transform: translateZ(calc(var(--gift-size) / -2 - 5px)) rotateY(180deg); }
        .lid-right { transform: translateX(50%) rotateY(90deg); }
        .lid-front { transform: translateZ(calc(var(--gift-size) / 2 + 5px)); }

        .present:hover .lid {
            animation: none;
        }

        .present.open {
            cursor: default;
        }

        .present.open .gift-video {
            transform: translate3d(-50%, -50%, 100px) rotateY(360deg) rotateX(5deg) scale(1);
        }

        .present.open .wiggle-container {
            animation: none;
        }

        .present.open .left { transform: translateX(-50%) rotateY(-90deg) rotateX(-90deg); }
        .present.open .back { transform: translateZ(calc(var(--gift-size) / -2)) rotateY(180deg) rotateX(-90deg); }
        .present.open .right { transform: translateX(50%) rotateY(90deg) rotateX(-90deg); }
        .present.open .front { transform: translateZ(calc(var(--gift-size) / 2)) rotateX(-90deg); }

        .present.open .lid {
            animation: none;
            transform: translate3d(0, -120px, -120px) rotateX(50deg);
        }

        .present.open .front,
        .present.open .left,
        .present.open .back,
        .present.open .right,
        .present.open .lid {
            transition: transform .5s ease-out;
        }

        .unmute-button {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 20px;
            background-color: #ff4500;
            color: white;
            font-size: 1.2em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            z-index: 10;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .unmute-button.show {
            opacity: 1;
            visibility: visible;
        }
        /* Styles for the navigation button */
        .nav-button {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            background-color: #4CAF50; /* Green */
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2em;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            z-index: 100; /* Ensure it's above other elements */
        }
        .nav-button:hover {
            background-color: #45a049;
            transform: translateX(-50%) translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }
        .nav-button:active {
            transform: translateX(-50%) translateY(0);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
  .confetti {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 5;
}

    </style>
</head>
<body>
    <canvas></canvas>

    <div class="headline">MERRY CHRISTMAS</div>

    <div class="instructions">Happy Birthday</div>

    <div class="present">
        <video class="gift-video" src="download1.mp4" loop playsinline></video>
        <div class="wiggle-container">
            <div class="rotate-container">
                <div class="bottom"></div>
                <div class="front"></div>
                <div class="left"></div>
                <div class="back"></div>
                <div class="right"></div>

                <div class="lid">
                    <div class="lid-top"></div>
                    <div class="lid-front"></div>
                    <div class="lid-left"></div>
                    <div class="lid-back"></div>
                    <div class="lid-right"></div>
                </div>
            </div>
        </div>
    </div>

    <button class="unmute-button">Unmute Video</button>
    <!-- Navigation Button -->
    <!-- Removed nav-button for last page -->
    <script>
        const countsNeeded = 1;
        let counts = 0;

        const present = document.querySelector('.present');
        const giftVideo = document.querySelector('.gift-video');
        const unmuteButton = document.querySelector('.unmute-button');

        // Initial setup for the unmute button (hidden)
        unmuteButton.classList.remove('show'); // Ensure it's hidden initially (CSS handles default visibility)
        unmuteButton.style.display = 'none'; // Explicitly hide it

        // Set video to be muted by default on load
        giftVideo.muted = true;

        present.addEventListener('click', async () => { // Added 'async' keyword
            counts += 1;
            present.style.setProperty('--count', Math.ceil(counts / 2));
            present.classList.add('animate');
            setTimeout(() => {
                present.classList.remove('animate');
            }, 300);

            if (counts >= countsNeeded) {
                present.classList.add('open');

                // Try to play the video. It will play muted because giftVideo.muted = true
                try {
                    await giftVideo.play();
                    console.log("Video started playing (muted).");
                } catch (error) {
                    console.error("Error attempting to play video:", error);
                    // If video playback truly fails, you might want to handle it (e.g., show an error message)
                }

                // Show the unmute button after the gift opens
                unmuteButton.style.display = 'block'; // Make it visible
                setTimeout(() => {
                    unmuteButton.classList.add('show');
                }, 10); // Small delay for transition
            }
        });

        unmuteButton.addEventListener('click', () => {
            if (giftVideo.muted) {
                giftVideo.muted = false;
                unmuteButton.textContent = 'Mute Video';
                console.log("Video unmuted.");
            } else {
                giftVideo.muted = true;
                unmuteButton.textContent = 'Unmute Video';
                console.log("Video muted.");
            }
        });


        // --- Snowflake animation code (unchanged) ---
        const canvas = document.querySelector('canvas');
        const ctx = canvas.getContext('2d');

        let width;
        let height;
        let lastNow;
        let snowflakes;
        let maxSnowflakes = 300;

        const rand = (min, max) => min + Math.random() * (max - min);

        class Snowflake {
            constructor() {
                this.spawn(true);
            }

            spawn(anyY = false) {
                this.x = rand(0, width);
                this.y = anyY === true
                    ? rand(-50, height + 50)
                    : rand(-50, -10);
                this.xVel = rand(-0.05, 0.05);
                this.yVel = rand(0.02, 0.1);
                this.angle = rand(0, Math.PI * 2);
                this.angleVel = rand(-0.001, 0.001);
                this.size = rand(5, 15);
                this.sizeOsc = rand(0.01, 0.5);
            }

            update(elapsed) {
                const xForce = rand(-0.001, 0.001);

                if (Math.abs(this.xVel + xForce) < 0.075) {
                    this.xVel += xForce;
                }

                this.x += this.xVel * elapsed;
                this.y += this.yVel * elapsed;
                this.angle += this.xVel * 0.05 * elapsed;

                if (
                    this.y - this.size > height
                    || this.x + this.size < 0
                    || this.x - this.size > width
                ) {
                    this.spawn();
                }

                this.render();
            }

           render() {
    ctx.save();
    const { x, y, size } = this;

    // Randomly choose between dark pink and purple
    const colors = ['rgba(199, 21, 133, 0.6)', 'rgba(138, 43, 226, 0.6)']; // dark pink, purple
    const color = colors[Math.floor(Math.random() * colors.length)];

    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.arc(x, y, size * 0.35, 0, Math.PI * 2, false);
    ctx.fill();
    ctx.restore();
}

        }

        function render(now) {
            requestAnimationFrame(render);

            const elapsed = now - lastNow;
            lastNow = now;

            ctx.clearRect(0, 0, width, height);
            if (snowflakes.length < maxSnowflakes) {
                snowflakes.push(new Snowflake());
            }

            ctx.strokeStyle = 'rgba(255, 105, 180, 0.5)'; // Hot pink
            ctx.fillStyle = 'rgba(255, 105, 180, 0.5)';


            snowflakes.forEach((snowflake) => snowflake.update(elapsed, now));
        }

        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;

            canvas.width = width;
            canvas.height = height;

            maxSnowflakes = Math.max(width / 10, 100);
        }

        function pause() {
            cancelAnimationFrame(render);
        }
        function resume() {
            lastNow = performance.now();
            requestAnimationFrame(render);
        }

        function init() {
            snowflakes = [];
            resize();
            render(lastNow = performance.now());
        }

        window.addEventListener('resize', resize);
        window.addEventListener('blur', pause);
        window.addEventListener('focus', resume);

        init();

        /* The original URL action loop (commented out) */
    </script>
</body>
</html>